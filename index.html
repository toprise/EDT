<!DOCTYPE html>
<html lang="zh">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>é€šç”¨åŠ å¯†è§£å¯†å·¥å…·</title>
  <!-- å¼•å…¥ä¸­æ–‡å­—ä½“ -->
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500&display=swap" rel="stylesheet" />
  <style>
    /* ä¸»é¢˜è‰²å˜é‡å®šä¹‰ */
    :root {
      --bg-light: #eaf6ff; --header-light: #cfe8fc; --btn-light: #a5d8ff;
      --bg-pink: #fff0f5; --header-pink: #ffd3e0; --btn-pink: #ffb0c9;
      --bg-dark: #2c2c2e; --header-dark: #3a3a3c; --btn-dark: #5e5e60;
      --txt-light: #333; --txt-dark: #f2f2f7;
    }
    body { font-family:'Noto Sans SC',sans-serif; margin:30px; display:flex; flex-direction:column; align-items:center; background:var(--bg-light); color:var(--txt-light); transition:background .3s, color .3s; }
    body.dark { background:var(--bg-dark); color:var(--txt-dark); }
    .card, .theme-card { width:800px; border-radius:20px; box-shadow:0 8px 20px rgba(0,0,0,0.15); transition:background .3s; }
    .card { background:#fff; overflow:hidden; } .card.dark { background:var(--bg-dark); }
    .theme-card { display:flex; justify-content:flex-end; gap:10px; margin-bottom:20px; padding:15px; background:var(--header-light); }
    .theme-card.dark { background:var(--header-dark); }
    .theme-btn, .lang-select { border:none; border-radius:12px; padding:8px 16px; cursor:pointer; background:#eee; transition:background .3s, color .3s; }
    .theme-card.dark .theme-btn, .theme-card.dark .lang-select { background:var(--btn-dark); color:var(--txt-dark); }
    .theme-btn.selected.blue { background:var(--btn-light); color:#fff; } .theme-btn.selected.pink { background:var(--btn-pink); color:#fff; }
    .tabs { display:flex; background:var(--header-light); } .tabs.dark { background:var(--header-dark); }
    .tabs div {
      flex: 1;
      text-align: center;
      padding: 12px 8px; /* å‡å°‘å·¦å³å†…è¾¹è·é¿å…æ¢è¡Œ */
      cursor: pointer;
      font-weight: 500;
      transition: background .3s;
      white-space: nowrap; /* ç¦æ­¢æ¢è¡Œ */
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .tabs div.active { background:var(--bg-light); border-bottom:3px solid #42a5f5; } .tabs.dark div.active { background:var(--header-dark); }
    .card-header { text-align:center; background:var(--header-light); padding:12px; font-size:20px; font-weight:500; transition:background .3s; }
    .card-header.dark { background:var(--header-dark); }
    .card-body { padding:20px; transition:background .3s; }
    .card-body.dark { background:var(--bg-dark); }
    .section { display:none; } .section.active { display:block; }
    label { display:block; margin-top:10px; font-weight:500; }
    textarea, select, input, button { width:100%; padding:10px; margin-top:5px; border-radius:8px; border:1px solid #ccc; font-size:14px; transition:background .3s, border .3s; }
    button { background:var(--btn-light); color:#fff; border:none; cursor:pointer; } body.dark button { background:var(--btn-dark); } button:hover { opacity:.9; }
    .disabled { background:#eee; cursor:not-allowed; }
    .storage { display:flex; gap:10px; margin-top:10px; } .storage button { flex:1; }
    #qrCode { margin-top:20px; }
    .about-content { font-size:16px; line-height:1.5; }
    .about-content a { color:#42a5f5; text-decoration:none; } .about-content a:hover { text-decoration:underline; }
  </style>
</head>

<body>
  <div class="theme-card" id="themeCard">
    <button class="theme-btn blue selected" onclick="setTheme('blue')">ğŸ”µ æµ…è“</button>
    <button class="theme-btn pink" onclick="setTheme('pink')">ğŸŒ¸ æ·¡ç²‰</button>
    <button class="theme-btn" onclick="toggleDark()">ğŸŒ“ å¤œé—´</button>
    <select class="lang-select" id="langSelect" onchange="setLang(this.value)"><option value="zh">ä¸­æ–‡</option><option value="en">English</option></select>
  </div>
  <div class="card" id="mainCard">
    <div class="tabs" id="tabs">
      <div id="tab-key" class="active" onclick="showSection('key')" data-i18n="tabKey">å¯†é’¥ç®¡ç†</div>
      <div id="tab-encrypt" onclick="showSection('encrypt')" data-i18n="tabEncrypt">åŠ å¯†</div>
      <div id="tab-decrypt" onclick="showSection('decrypt')" data-i18n="tabDecrypt">è§£å¯†</div>
      <div id="tab-hash" onclick="showSection('hash')" data-i18n="tabHash">å“ˆå¸Œä¸ HMAC</div>
      <div id="tab-qr" onclick="showSection('qr')" data-i18n="tabQR">äºŒç»´ç ç”Ÿæˆ</div>
      <div id="tab-file" onclick="showSection('file')" data-i18n="tabFile">æ–‡ä»¶åŠ å¯†/è§£å¯†</div>
      <div id="tab-about" onclick="showSection('about')">å…³äº</div>
    </div>
    <div class="card-header" id="header" data-i18n="tabKey">å¯†é’¥ç®¡ç†</div>
    <div class="card-body" id="body">
      <!-- å¯†é’¥ç®¡ç† -->
      <div id="section-key" class="section active">
        <label>é€‰æ‹© RSA å¯†é’¥é•¿åº¦ï¼š</label>
        <select id="keySize" onchange="onKeyLen()"><option value="">-- è¯·é€‰æ‹© --</option><option>512</option><option>1024</option><option>2048</option></select>
        <button id="genBtn" class="disabled" onclick="genRSA()" disabled>ç”Ÿæˆå¯†é’¥å¯¹</button>
        <div class="storage"><button onclick="saveRSA()">ğŸ’¾ ä¿å­˜å¯†é’¥</button><button onclick="loadRSA()">ğŸ“‚ åŠ è½½å¯†é’¥</button></div>
        <label>å…¬é’¥ï¼ˆPEMï¼‰</label><textarea id="pubKey"></textarea>
        <label>ç§é’¥ï¼ˆPEMï¼‰</label><textarea id="priKey"></textarea>
      </div>
      <!-- åŠ å¯† -->
      <div id="section-encrypt" class="section">
        <label>ç®—æ³•ï¼š</label>
        <select id="algoEnc" onchange="togglePane('Enc')"><option>RSA-OAEP</option><option>RSAES-PKCS1-V1_5</option><option>AES-CBC</option></select>
        <div id="rsaEncPane"><label>å¾…åŠ å¯†æ˜æ–‡ï¼š</label><textarea id="textInEnc"></textarea></div>
        <div id="aesEncPane" style="display:none"><label>å¯†ç ï¼š</label><input type="password" id="aesPwdEnc"/><label>å¾…åŠ å¯†æ˜æ–‡ï¼š</label><textarea id="textInAESEnc"></textarea></div>
        <button onclick="doEncrypt()">åŠ å¯†</button>
        <label>ç»“æœ(Base64)ï¼š</label><textarea id="textOutEnc" readonly></textarea>
      </div>
      <!-- è§£å¯† -->
      <div id="section-decrypt" class="section">
        <label>ç®—æ³•ï¼š</label>
        <select id="algoDec" onchange="togglePane('Dec')"><option>RSA-OAEP</option><option>RSAES-PKCS1-V1_5</option><option>AES-CBC</option></select>
        <div id="rsaDecPane"><label>å¾…è§£å¯†å¯†æ–‡(Base64)ï¼š</label><textarea id="textInDec"></textarea></div>
        <div id="aesDecPane" style="display:none"><label>å¯†ç ï¼š</label><input type="password" id="aesPwdDec"/><label>å¾…è§£å¯†å¯†æ–‡(Base64)ï¼š</label><textarea id="textInAESDec"></textarea></div>
        <button onclick="doDecrypt()">è§£å¯†</button>
        <label>è§£å¯†ç»“æœï¼š</label><textarea id="textOutDec" readonly></textarea>
      </div>
      <!-- å“ˆå¸Œä¸ HMAC -->
      <div id="section-hash" class="section">
        <label>é€‰æ‹©ç®—æ³•ï¼š</label><select id="hashAlgo"><option>SHA-256</option><option>SHA-512</option><option>MD5</option></select>
        <label>è¾“å…¥å†…å®¹ï¼š</label><textarea id="hashInput"></textarea><button onclick="generateHash()">ç”Ÿæˆå“ˆå¸Œ</button><label>å“ˆå¸Œç»“æœï¼š</label><textarea id="hashOutput" readonly></textarea>
        <label>é€‰æ‹© HMAC ç®—æ³•ï¼š</label><select id="hmacAlgo"><option>SHA-256</option><option>SHA-512</option><option>MD5</option></select>
        <label>å¯†é’¥ï¼š</label><input type="text" id="hmacKey"/><label>è¾“å…¥å†…å®¹ï¼š</label><textarea id="hmacInput"></textarea><button onclick="generateHMAC()">ç”Ÿæˆ HMAC</button><label>HMAC ç»“æœï¼š</label><textarea id="hmacOutput" readonly></textarea>
      </div>
      <!-- äºŒç»´ç ç”Ÿæˆ -->
      <div id="section-qr" class="section">
        <label>è¾“å…¥æ–‡æœ¬ï¼š</label><textarea id="qrText"></textarea><button onclick="generateQRCode()">ç”ŸæˆäºŒç»´ç </button><div id="qrCode"></div>
      </div>
      <!-- æ–‡ä»¶ -->
      <div id="section-file" class="section">
        <label>é€‰æ‹©æ–‡ä»¶ï¼š</label><input type="file" id="fileInput"/>
        <button id="encryptFileBtn" disabled>åŠ å¯†æ–‡ä»¶</button><button id="decryptFileBtn" disabled>è§£å¯†æ–‡ä»¶</button>
      </div>
      <!-- å…³äº -->
      <div id="section-about" class="section">
        <div class="about-content">
          <p>ä½œè€…ï¼šYour Name</p><p>ç‰ˆæœ¬ï¼šv1.0.0</p><p>GitHubï¼š<a href="https://github.com/your-repo" target="_blank">ä»“åº“é“¾æ¥</a></p>
        </div>
      </div>
    </div>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/node-forge@1.3.1/dist/forge.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>
  <script>
    const I18N={zh:{tabKey:'å¯†é’¥ç®¡ç†',tabEncrypt:'åŠ å¯†',tabDecrypt:'è§£å¯†',tabHash:'å“ˆå¸Œä¸ HMAC',tabQR:'äºŒç»´ç ç”Ÿæˆ',tabFile:'æ–‡ä»¶åŠ å¯†/è§£å¯†',dark:'å¤œé—´'},en:{tabKey:'Key Mgmt',tabEncrypt:'Encrypt',tabDecrypt:'Decrypt',tabHash:'Hash & HMAC',tabQR:'QR Code',tabFile:'File Enc/Dec',dark:'Dark'}};
    let lang='zh',rsaPub,rsaPri;
    function setLang(l){lang=l;document.querySelectorAll('[data-i18n]').forEach(e=>{e.textContent=I18N[lang][e.getAttribute('data-i18n')];});updateHeader();}
    function updateHeader(){const sec=document.querySelector('.tabs .active').id.replace('tab-','');document.getElementById('header').textContent= sec==='about'? 'å…³äº':I18N[lang]['tab'+sec.charAt(0).toUpperCase()+sec.slice(1)];}
    function setTheme(c){document.querySelectorAll('.theme-btn').forEach(b=>b.classList.remove('selected'));document.querySelector(`.theme-btn.${c}`).classList.add('selected');const m={blue:['#eaf6ff','#cfe8fc','#a5d8ff'],pink:['#fff0f5','#ffd3e0','#ffb0c9']}[c];document.documentElement.style.setProperty('--bg-light',m[0]);document.documentElement.style.setProperty('--header-light',m[1]);document.documentElement.style.setProperty('--btn-light',m[2]);document.querySelector('.tabs').style.background=m[1];document.querySelector('.card-header').style.background=m[1];document.querySelectorAll('button:not(.theme-btn)').forEach(b=>b.style.backgroundColor=m[2]);}
    function toggleDark(){['body','themeCard','mainCard','tabs','header'].forEach(id=>document.getElementById(id)?.classList.toggle('dark'));document.body.classList.toggle('dark');}
    function showSection(sec){['key','encrypt','decrypt','hash','qr','file','about'].forEach(s=>{document.getElementById('section-'+s).classList.remove('active');document.getElementById('tab-'+s)?.classList.remove('active');});document.getElementById('section-'+sec).classList.add('active');document.getElementById('tab-'+sec)?.classList.add('active');updateHeader();}
    function onKeyLen(){const ok=!!document.getElementById('keySize').value;document.getElementById('genBtn').disabled=!ok;document.getElementById('genBtn').classList.toggle('disabled',!ok);}    
    function genRSA(){const bits=+document.getElementById('keySize').value;const kp=forge.pki.rsa.generateKeyPair({bits,e:0x10001});rsaPub=kp.publicKey;rsaPri=kp.privateKey;document.getElementById('pubKey').value=forge.pki.publicKeyToPem(rsaPub);document.getElementById('priKey').value=forge.pki.privateKeyToPem(rsaPri);}    
    function saveRSA(){localStorage.setItem('rsa_pub',document.getElementById('pubKey').value);localStorage.setItem('rsa_pri',document.getElementById('priKey').value);alert('å·²ä¿å­˜å¯†é’¥');}
    function loadRSA(){const sp=localStorage.getItem('rsa_pub'),si=localStorage.getItem('rsa_pri'),pub=document.getElementById('pubKey'),pri=document.getElementById('priKey');if(sp||si){if(sp)pub.value=sp;if(si)pri.value=si;return;}if(!pub.value.trim()&&!pri.value.trim())alert('æ— å¯ç”¨å¯†é’¥');}
    function togglePane(m){['rsa','aes'].forEach(p=>document.getElementById(p+m+'Pane').style.display='none');const algo=document.getElementById('algo'+m).value,pane=(algo.startsWith('RSA')?'rsa':'aes')+m+'Pane';document.getElementById(pane).style.display='block';}
    function doEncrypt(){let out,algo=document.getElementById('algoEnc').value;if(algo==='AES-CBC'){const pwd=document.getElementById('aesPwdEnc').value,salt=forge.random.getBytesSync(16),iv=forge.random.getBytesSync(16),key=forge.pkcs5.pbkdf2(pwd,salt,1000,16),cipher=forge.cipher.createCipher('AES-CBC',key);cipher.start({iv});cipher.update(forge.util.createBuffer(document.getElementById('textInAESEnc').value,'utf8'));cipher.finish();const buf=forge.util.createBuffer();buf.putBytes(salt);buf.putBytes(iv);buf.putBuffer(cipher.output);out=forge.util.encode64(buf.getBytes());}else{loadRSA();out=forge.util.encode64(rsaPub.encrypt(forge.util.encodeUtf8(document.getElementById('textInEnc').value),algo));}document.getElementById('textOutEnc').value=out;}
    function doDecrypt(){let out,algo=document.getElementById('algoDec').value;if(algo==='AES-CBC'){try{const pwd=document.getElementById('aesPwdDec').value,data=forge.util.decode64(document.getElementById('textInAESDec').value),buf=forge.util.createBuffer(data),salt=buf.getBytes(16),iv=buf.getBytes(16),ct=buf.getBytes(buf.length()),key=forge.pkcs5.pbkdf2(pwd,salt,1000,16),dec=forge.cipher.createDecipher('AES-CBC',key);dec.start({iv});dec.update(forge.util.createBuffer(ct));out=dec.finish()?forge.util.decodeUtf8(dec.output.getBytes()):'è§£å¯†å¤±è´¥ï¼šå¯†ç é”™è¯¯æˆ–æ•°æ®æŸå';}catch(e){out='è§£å¯†å¤±è´¥ï¼šæ•°æ®æ ¼å¼é”™è¯¯';}}else{loadRSA();out=forge.util.decodeUtf8(rsaPri.decrypt(forge.util.decode64(document.getElementById('textInDec').value),algo));}document.getElementById('textOutDec').value=out;}
    function generateHash(){const algo=document.getElementById('hashAlgo').value.toLowerCase().replace('-',''),md=forge.md[algo].create();md.update(document.getElementById('hashInput').value,'utf8');document.getElementById('hashOutput').value=md.digest().toHex();}
    function generateHMAC(){const algo=document.getElementById('hmacAlgo').value.toLowerCase().replace('-',''),key=document.getElementById('hmacKey').value,hmac=forge.hmac.create().start(algo,key);hmac.update(document.getElementById('hmacInput').value,'utf8');document.getElementById('hmacOutput').value=hmac.digest().toHex();}
    function generateQRCode(){const text=document.getElementById('qrText').value.trim(),container=document.getElementById('qrCode');container.innerHTML='';if(!text)return alert('è¯·è¾“å…¥äºŒç»´ç æ–‡æœ¬');QRCode.toCanvas(container,text,{},err=>{if(err)alert('äºŒç»´ç ç”Ÿæˆå¤±è´¥');});}
    const fileInput=document.getElementById('fileInput'),encryptFileBtn=document.getElementById('encryptFileBtn'),decryptFileBtn=document.getElementById('decryptFileBtn');fileInput.addEventListener('change',()=>{const has=document.getElementById('pubKey').value.trim()||document.getElementById('priKey').value.trim();encryptFileBtn.disabled=!has||!fileInput.files.length;decryptFileBtn.disabled=!has||!fileInput.files.length;});encryptFileBtn.addEventListener('click',()=>{const f=fileInput.files[0],r=new FileReader();r.onload=()=>{const bin=r.result,combined=bin+document.getElementById('priKey').value,enc=btoa(combined);downloadBlob(enc,f.name+'.enc','application/octet-stream');};r.readAsBinaryString(f);});decryptFileBtn.addEventListener('click',()=>{const f=fileInput.files[0],r=new FileReader();r.onload=()=>{try{const enc=r.result,combined=atob(enc),key=document.getElementById('priKey').value;if(!combined.endsWith(key))throw'';const bin=combined.slice(0,-key.length),name=f.name.endsWith('.enc')?f.name.slice(0,-4):'decrypted_'+f.name;downloadBlob(bin,name,'application/octet-stream');}catch{alert('æ–‡ä»¶è§£å¯†å¤±è´¥ï¼šå¯†é’¥ä¸åŒ¹é…æˆ–æ–‡ä»¶æ ¼å¼é”™è¯¯');}};r.readAsBinaryString(f);});function downloadBlob(b,fn,m){const bin=atob(b),arr=new Uint8Array(bin.length);for(let i=0;i<bin.length;i++)arr[i]=bin.charCodeAt(i);const blob=new Blob([arr],{type:m}),url=URL.createObjectURL(blob),a=document.createElement('a');a.href=url;a.download=fn;document.body.appendChild(a);a.click();document.body.removeChild(a);URL.revokeObjectURL(url);}  
  </script>
</body>
</html>
